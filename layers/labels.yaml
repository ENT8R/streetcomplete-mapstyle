layers:

    road-labels:
        data: { source: thunderforest, layer: road-label }
        filter: { $zoom: { min: 14 } }
        draw:
            text:
                text_source: global.name_source
                buffer: 8px
                text_wrap: 25
                max_lines: 3
                priority: 20
                font:
                    family: global.text_font_family
                    fill: global.text_fill_color
                    size: global.text_size
                    stroke: global.text_stroke
                    weight: normal
        oneway:
            filter: { oneway: yes, $zoom: { min: 17 } }
            draw:
                oneway-arrow:
                    flat: true
                    buffer: 2px
                    color: global.oneway_arrow_color
                    size: [[17, [6px, auto]], [20, [18px, auto]]]
                    placement: spaced
                    placement_spacing: [[17, 64px], [20, 256px]]
                    angle: auto
                    text:
                        visible: false

    path-labels:
        data: { source: thunderforest, layer: path-label }
        filter: { $zoom: { min: 14 } }
        draw:
            text:
                text_source: global.name_source
                buffer: 8px
                text_wrap: 25
                max_lines: 3
                priority: 20
                font:
                    family: global.text_font_family
                    fill: global.text_fill_color
                    size: global.text_size
                    stroke: global.text_stroke
                    weight: normal

    water-labels:
        data: { source: thunderforest, layer: [waterway-label, water-label] }
        draw:
            text:
                text_source: global.name_source
                buffer: 12px
                priority: function() { return feature.labelrank }
                font:
                    family: global.text_font_family
                    fill: global.text_water_color
                    size: global.text_size
                    stroke: global.text_water_stroke

    country-labels:
        data: { source: thunderforest, layer: country-label }
        draw:
            text:
                text_source: global.name_source
                buffer: 12px
                priority: function() { return feature.labelrank }
                font:
                    family: global.text_font_family
                    fill: global.text_fill_color
                    size: global.text_size
                    stroke: global.text_countries_stroke
                    transform: uppercase
                    weight: bold

    # thunderforest: there is also layer state-label, landcover-label, landuse-label

    place-labels:
        data: { source: thunderforest, layer: place-label }
        draw:
            text:
                visible: false
                text_source: global.name_source
                buffer: 4px
                priority: function() { return 6 + feature.place_priority }
                font:
                    family: global.text_font_family
                    fill: global.text_fill_color
                    size: global.text_size
                    stroke: global.text_places_stroke

        city:
            filter: { place: city, $zoom: { min: 6 } }
            draw:
                text:
                    visible: true
                    font:
                        weight: bold

        town-and-suburb:
            filter: { place: [town, suburb], $zoom: { min: 9 } }
            draw:
                text:
                    visible: true

        village-and-neighbourhood:
            filter: { place: [village, neighbourhood], $zoom: { min: 11 } }
            draw:
                text:
                    visible: true

        other:
            filter: { place: [hamlet, isolated_dwelling], $zoom: { min: 13 } }
            draw:
                text:
                    visible: true

    housenumber-labels:
        data: { source: thunderforest, layer: address }
        filter: { $zoom: { min: 19 } }
        draw:
            text:
                text_source: addr_housenumber
                priority: 30
                font:
                    family: global.text_font_family
                    fill: global.text_fill_color
                    size: global.text_size
                    stroke: global.text_stroke

global:
    name_source: |
        function() {
            // Use preferred language label if available
            return (global.language && feature['name_'+global.language]) || feature.name;
        }

styles:
    oneway-arrow:
        base: points
        texture: oneway-arrow