import:
    - https://raw.githubusercontent.com/ENT8R/streetcomplete-mapstyle/master/global.yaml
#import:
    #- global.yaml

layers:
    #Everything which is not water
    earth:
        data: { source: mapzen }
        draw:
            polygons:
                order: function() { return feature.sort_rank; }
                color: global.earth_color

    #Everything which is water
    water:
        data: { source: mapzen, layer: water }
        water_lines:
            filter:
                all:
                    - $geometry: line
                    - kind: [river, canal, stream, dam, ditch, drain]
                    - not: {is_tunnel: true}
                any:
                    - $zoom: { min: 13 }
                    - kind: [river, canal]
            draw:
                lines:
                    order: function() { return feature.sort_rank; }
                    color: global.water_color
                    width: [[13, 1px], [14, 1.5px], [15, 2px], [16, 3px], [18, 4m]]
                    cap: round

        water_areas:
            draw:
                polygons:
                    order: function() { return feature.sort_rank; }
                    color: global.water_color

        water-labels:
            filter:
                all:
                    - name: true
            draw:
                text:
                    visible: false
                    text_source: global.name_source
                    font:
                        fill: global.text_fill_color
                        family: global.text_font_family

            ocean-labels:
                filter:
                    all:
                        - $zoom: { min: 3 }
                        - kind: ocean
                draw:
                    text:
                        visible: true

            sea-labels:
                filter:
                    all:
                        - $zoom: { min: 6 }
                        - kind: sea
                draw:
                    text:
                        visible: true

            water-area-labels:
                filter:
                    all:
                        - name: true
                        - $geometry: point
                        - not: { kind: [riverbank, dock, playa] }
                        - area: true
                    any:
                        # show labels for smaller areas at higher zooms
                        - { $zoom: { min: 5 },  area: { min: 10000000000 } }
                        - { $zoom: { min: 6 },  area: { min: 5000000000 } }
                        - { $zoom: { min: 7 },  area: { min: 400000000 } }
                        - { $zoom: { min: 8 },  area: { min: 200000000 } }
                        - { $zoom: { min: 9 },  area: { min: 100000000 } }
                        - { $zoom: { min: 10 }, area: { min: 100000000 } }
                        - { $zoom: { min: 11 }, area: { min: 10000000 } }
                        - { $zoom: { min: 12 }, area: { min: 2000000 } }
                        - { $zoom: { min: 13 }, area: { min: 1000000 } }
                        - { $zoom: { min: 14 }, area: { min: 500000 } }
                        - { $zoom: { min: 15 }, area: { min: 100000 } }
                        - { $zoom: { min: 15 }, area: { min: 50000 } }
                        - { $zoom: { min: 16 }, area: { min: 20000 } }
                        - { $zoom: { min: 17 } }
                draw:
                    text:
                        visible: true

            water-line-labels:
                filter:
                    all:
                        - $geometry: line
                        - kind: [river,canal]
                        - $zoom: { min: 14 }
                draw:
                    text:
                        visible: true

    landuse:
        data: { source: mapzen }
        draw:
            polygons:
                order: function() { return feature.sort_rank; }
                color: global.landuse_color

    #All buildings
    buildings:
        data: { source: mapzen }
        filter: {$zoom: { min: 16 }, not: { location: underground }}

        draw:
            polygons:
                order: function() { return feature.sort_rank; }
                color: global.building_color
            lines:
                order: function() { return feature.sort_rank; }
                color: global.building_outline
                width: [[14, 0px], [15, 1px], [18, 1px], [19, 0.6m]]


        3d-buildings:
            draw:
                polygons:
                    extrude: function () { return feature.height > 20 || $zoom >= 16; }


        address-labels:
            filter:
                all:
                    - $zoom: { min: 19 }
                any:
                    - kind: address
                    - { label_position: true, addr_housenumber: true, name: false }
            draw:
                text:
                    order: function() { return feature.sort_rank; }
                    text_source: addr_housenumber
                    font:
                        fill: global.text_fill_color
                        family: global.text_font_family
                        size: global.text_size
                        stroke: global.text_stroke
