layers:

    #All roads
    roads:
        data: { source: mapzen}
        filter:
            not: { kind: [rail, ferry] }
        draw:
            lines:
                order: function() { return feature.sort_rank; }
                cap: round
                color: global.road_color
                width: [[5, 1px], [12, 2px], [16, 5px], [17, 7m]]

        highway:
            filter:
                kind: highway
            draw:
                lines:
                    width: [[5, 2px], [14, 5px], [15, 12]]
                    order: function() { return feature.sort_rank; }

        major_road:
            filter:
                kind: major_road
            draw:
                lines:
                    order: function() { return feature.sort_rank; }
                    width: [[10, 0px], [14, 2px], [16, 6px], [19, 8m]]

        minor_road:
            filter: { kind: minor_road, not: { kind_detail: service } }
            draw:
                lines:
                    order: function() { return feature.sort_rank; }
                    width: [[11, 0.5px], [12, 0.75px], [13, 1.0px], [14, 1.2px], [15, 2.5px], [16, 6m]]

        service_road:
            filter: { kind: minor_road, kind_detail: service }
            draw:
                lines:
                    width: [[13, 0.5px], [17, 3px], [18, 3m]]

        # default outlines starting at zoom 15
        default-outline-width:
            filter: { $zoom: { min: 15 } }
            draw:
                lines:
                    outline:
                        color: global.road_outline
                        width: function () { return 3/16 * Math.log($zoom); }

        path:
            filter:
                all:
                    - kind: [path, portage_way]
            draw:
                lines:
                    color: global.path_color
                    width: [[14, 0.5px], [15, 1.5px], [17, 3m]]
                    outline:
                        color: global.path_outline
                        width: [[15, 0px], [17, 0px], [18, 1px]]

    places:
        data: { source: mapzen, layer: places }
        filter:
            all:
                - name: true
                - not: {source: [whosonfirst.mapzen.com]}
        draw:
            text:
                text_source: global.name_source
                visible: true
                buffer: 3px
                font:
                    fill: global.text_fill_color
                    family: global.text_font_family
